"""empty message

Revision ID: 41969455ddc7
Revises: 4d45ccc4e1eb
Create Date: 2020-09-24 11:15:01.337612

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import mysql

# revision identifiers, used by Alembic.
revision = '41969455ddc7'
down_revision = '4d45ccc4e1eb'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index('access_token', table_name='oauth2_token')
    op.drop_index('ix_oauth2_token_refresh_token', table_name='oauth2_token')
    op.drop_table('oauth2_token')
    op.drop_index('code', table_name='oauth2_code')
    op.drop_table('oauth2_code')
    op.drop_index('ix_oauth2_client_client_id', table_name='oauth2_client')
    op.drop_table('oauth2_client')
    op.add_column('adherents', sa.Column('ldap_login', sa.String(length=255), nullable=True))
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column('adherents', 'ldap_login')
    op.create_table('oauth2_client',
    sa.Column('client_id', mysql.VARCHAR(length=48), nullable=True),
    sa.Column('client_secret', mysql.VARCHAR(length=120), nullable=True),
    sa.Column('client_id_issued_at', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('client_secret_expires_at', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('client_metadata', mysql.TEXT(), nullable=True),
    sa.Column('id', mysql.INTEGER(display_width=11), autoincrement=True, nullable=False),
    sa.Column('user_id', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.Column('bypass_consent', mysql.TINYINT(display_width=1), autoincrement=False, nullable=False),
    sa.ForeignKeyConstraint(['user_id'], ['adherents.id'], name='oauth2_client_ibfk_1', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    mysql_default_charset='latin1',
    mysql_engine='InnoDB'
    )
    op.create_index('ix_oauth2_client_client_id', 'oauth2_client', ['client_id'], unique=False)
    op.create_table('oauth2_code',
    sa.Column('code', mysql.VARCHAR(length=120), nullable=False),
    sa.Column('client_id', mysql.VARCHAR(length=48), nullable=True),
    sa.Column('redirect_uri', mysql.TEXT(), nullable=True),
    sa.Column('response_type', mysql.TEXT(), nullable=True),
    sa.Column('scope', mysql.TEXT(), nullable=True),
    sa.Column('nonce', mysql.TEXT(), nullable=True),
    sa.Column('auth_time', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('code_challenge', mysql.TEXT(), nullable=True),
    sa.Column('code_challenge_method', mysql.VARCHAR(length=48), nullable=True),
    sa.Column('id', mysql.INTEGER(display_width=11), autoincrement=True, nullable=False),
    sa.Column('user_id', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['adherents.id'], name='oauth2_code_ibfk_1', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    mysql_default_charset='latin1',
    mysql_engine='InnoDB'
    )
    op.create_index('code', 'oauth2_code', ['code'], unique=True)
    op.create_table('oauth2_token',
    sa.Column('client_id', mysql.VARCHAR(length=48), nullable=True),
    sa.Column('token_type', mysql.VARCHAR(length=40), nullable=True),
    sa.Column('access_token', mysql.VARCHAR(length=255), nullable=False),
    sa.Column('refresh_token', mysql.VARCHAR(length=255), nullable=True),
    sa.Column('scope', mysql.TEXT(), nullable=True),
    sa.Column('revoked', mysql.TINYINT(display_width=1), autoincrement=False, nullable=True),
    sa.Column('issued_at', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('expires_in', mysql.INTEGER(display_width=11), autoincrement=False, nullable=False),
    sa.Column('id', mysql.INTEGER(display_width=11), autoincrement=True, nullable=False),
    sa.Column('user_id', mysql.INTEGER(display_width=11), autoincrement=False, nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['adherents.id'], name='oauth2_token_ibfk_1', ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    mysql_default_charset='latin1',
    mysql_engine='InnoDB'
    )
    op.create_index('ix_oauth2_token_refresh_token', 'oauth2_token', ['refresh_token'], unique=False)
    op.create_index('access_token', 'oauth2_token', ['access_token'], unique=True)
    # ### end Alembic commands ###
